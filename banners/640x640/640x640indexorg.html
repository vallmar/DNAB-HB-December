<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="ad.size" content="width=640,height=640">
    <title>Banner 640x640</title>
    <style>
        @font-face {
            font-family: 'Handelsbanken Sans';
            src: url('WOFF2/HandelsbankenSans-Bold.woff2') format('woff2');
            font-weight: bold;
            font-style: normal;
        }

        html,
        body {
            margin: 0;
            padding: 0;
            width: 640px;
            height: 640px;
            overflow: hidden;
        }

        body {
            font-family: 'Handelsbanken Sans', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        #ad {
            position: relative;
            width: 640px;
            height: 640px;
            background: #002f4d;
            overflow: hidden;
        }

        .top-image {
            display: block;
            width: 600px;
            height: 280px;
            margin: 20px 20px 0 20px;
            border-radius: 6px;
            object-fit: cover;
        }

        .copy {
            position: absolute;
            left: 24px;
            top: 320px;
            right: 24px;
        }

        .headline {
            margin: 0;
            padding: 0;
        }

        .headline .line {
            display: block;
            letter-spacing: -0.02em;
            font-size: 52px;
            line-height: 52px;
        }

        .headline .line.white {
            color: #ffffff;
        }

        .headline .line.blue {
            color: #31a7db;
        }

        .subcopy {
            position: absolute;
            left: 24px;
            bottom: 30px;
            color: #ffffff;
            font-size: 22px;
            line-height: 1.15;
            letter-spacing: -0.01em;
        }

        .wordmark {
            position: absolute;
            right: 24px;
            bottom: 32px;
            width: 290px;
            height: auto;
        }
        .pivot.line {
            opacity: 1;
        }
        .pivot {
            opacity: 0;
            transform: translate(56px, 0px);
            will-change: transform, opacity;
        }

                .pivot.headline {
            opacity: 0;
            transform: translate(0px, 36px);
            will-change: transform, opacity;
        }
        .pivot.is-y {
            opacity: 1;
            transform: translate(0px, 0px);
            transition: transform 520ms cubic-bezier(0.2, 0.0, 0.0, 1.0), opacity 520ms cubic-bezier(0.2, 0.0, 0.0, 1.0);
        }

        .pivot.is-x {
            transform: translate(0px, 0px);
            opacity: 1;

            transition: transform 420ms cubic-bezier(0.2, 0.0, 0.0, 1.0);
        }
    </style>
</head>

<body>
    <div id="ad" aria-label="Handelsbanken banner 640x640">
        <img class="top-image" src="Se_klart_640x640_6px.jpg" alt="">

        <div class="copy" aria-hidden="true">
            <h1 class="headline pivot is-y">
                <span class="line white pivot is-x" data-pivot-group="headline">Se klart.</span>
                <span class="line blue pivot is-x" data-pivot-group="headline">Med långsiktig</span>
                <span class="line blue pivot is-x" data-pivot-group="headline">Private Banking</span>
                <span class="line blue pivot is-x" data-pivot-group="headline">nära dig.</span>
            </h1>
        </div>

        <div class="subcopy pivot is-x" data-pivot-group="subcopy" aria-hidden="true">
            Välkommen att boka<br>
            ett personligt samtal
        </div>

        <img class="wordmark pivot is-x" src="HB_Wordmark.svg" alt="Handelsbanken">
    </div>

    <script>
        (function () {

            function onReady(fn) {
                if (document.readyState === 'complete' || document.readyState === 'interactive') {
                    window.setTimeout(fn, 0);
                    return;
                }
                document.addEventListener('DOMContentLoaded', fn, { once: true });
            }

            var prefersReducedMotion = false;
            try {
                prefersReducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            } catch (e) {
                prefersReducedMotion = false;
            }

            var Y_DURATION = 520;

            function setInitial(el) {
                el.classList.remove('is-y');
                el.classList.remove('is-x');
                // Keep base .pivot styles for initial state
            }

            function pivotIn(el, delayMs) {
                console.log(delayMs);
                const yMovement = el.classList.contains('is-y');
                setInitial(el);
                // if (prefersReducedMotion) {
                //     el.style.opacity = '1';
                //     el.style.transform = 'translate(0px, 0px)';
                //     return;
                // }

                // Phase 1: Vertical move (Y) + fade in. X stays constant.
                window.setTimeout(function () {
                    if(yMovement) {
                        el.classList.add('is-y');
                        
                console.log(yMovement);
                    }
                    else{

                        // Phase 2: Horizontal move (X only). Y stays at 0.
                        window.setTimeout(function () {
                            el.classList.add('is-x');
                        }, Y_DURATION);
                        
                    }
                }, delayMs);
            }

            function run() {
                var headlineLines = Array.prototype.slice.call(document.querySelectorAll('[data-pivot-group="headline"]'));
                var subcopy = document.querySelector('[data-pivot-group="subcopy"]');
                var copyContainer = document.querySelector('.headline.pivot');
                var wordmark = document.querySelector('.wordmark');
                console.log(copyContainer);
                pivotIn(copyContainer, 0);
                for (var i = 0; i < headlineLines.length; i++) {
                    pivotIn(headlineLines[i], 500 +(i * 40));
                }

                if (subcopy) {
                    pivotIn(subcopy, 720);
                    pivotIn(wordmark, 720);
                }
            }
            onReady(function () {
                // Defer one frame so layout styles apply before we toggle classes.
                window.requestAnimationFrame(run);
            });
        })();
    </script>
</body>

</html>